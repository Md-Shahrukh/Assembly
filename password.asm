		ORG 00H
		MOV R1,#05
		MOV R2,#03
		MOV DPTR,#CMD1
X1:		CLR A
		MOVC A,@A+DPTR
		ACALL CMD
		INC DPTR
		ACALL DELAY
		DJNZ R1,X1
		MOV TMOD,#20H
		MOV TH1,#-3
		SETB TR1
		MOV SCON,#50H
		CLR A
		ACALL Z1
		MOV A,SBUF
		MOV SBUF,#'*'
		CJNE A,#31H,V1
		MOV R5,#01
V1:		ACALL DAT
		ACALL DELAY
		ACALL Z1
		MOV A,SBUF
		MOV SBUF,#'*'
		CJNE A,#32H,V2
		INC R5
V2:		ACALL DAT
		ACALL DELAY
		ACALL Z1
		MOV A,SBUF
		MOV SBUF,#'*'
		CJNE A,#33H,V3
		INC R5
V3:		ACALL DAT
		ACALL DELAY
		ACALL Z1
		MOV A,SBUF
		MOV SBUF,#'*'
		ACALL Z2
		CJNE A,#34H,V4
		INC R5
V4:		CJNE R5,#04,X2
		ACALL DAT
		ACALL DELAY
		MOV A,#01H
		ACALL CMD
		ACALL X3
		SJMP $
			
X2:		MOV DPTR,#WRT
X6:		CLR A
		MOVC A,@A+DPTR
		JZ X7
		MOV SBUF,A
		INC DPTR
		ACALL Z2
		ACALL DAT
		SJMP X6
		
X3:		MOV DPTR,#RTR
X4:		CLR A
		MOVC A,@A+DPTR
		JZ X5
		MOV SBUF,A
		INC DPTR
		ACALL Z2
		ACALL DAT
		SJMP X4

X5:		DJNZ R2,X1
		MOV DPTR,#ACC
		JZ X7
		MOV SBUF,A
		INC DPTR
		ACALL DAT
		SJMP X5
X7:		SJMP $
		
Z1:		JNB RI,Z1
		CLR RI
		RET

Z2:		JNB T1,Z2
		CLR TI
		RET

DAT:	MOV P2,A
		SETB P0.0
		CLR P0.1
		SETB P0.2
		ACALL DELAY
		CLR P0.2
		CLR A
		RET	

CMD:	MOV P2,A
		CLR P0.0
		CLR P0.1
		SETB P0.2
		ACALL DELAY
		CLR P0.2
		RET

DELAY: 	MOV R0,#200
Q1:		MOV R4,#200
Q2:		DJNZ R4,Q2
		DJNZ R0,Q1
		RET
		
		ORG 250H
CMD1:	DB 38H,0EH,01H,06H,80H,0
WRT:		DB "WRONG PASSWORD",0
RTR:		DB "CORRECT PASSWORD",0
	ACC:		DB "AUTHENTICATION FAIL",0

		END	